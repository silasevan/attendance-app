{% extends "base.html" %} {% block title %}Register{% endblock %} {% block
content %}
<div
  class="container d-flex justify-content-center align-items-center"
  style="min-height: 80vh"
>
  <div class="card shadow p-4 col-12 col-md-6 col-lg-4">
    <h2 class="text-center mb-4">Register</h2>
    <form method="POST" action="{{ url_for('main.register') }}" novalidate>
      {{ form.hidden_tag() }}
      <div class="mb-3">
        {{ form.name.label(class="form-label") }} {{
        form.name(class="form-control") }} {% for error in form.name.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %}
      </div>
      <div class="mb-3">
        {{ form.email.label(class="form-label") }} {{
        form.email(class="form-control") }} {% for error in form.email.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %}
      </div>
      <div class="mb-3">
        {{ form.password.label(class="form-label") }} {{
        form.password(class="form-control",
        pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()-_=+]).{8,}",
        title="Password must contain at least 8 characters, including uppercase,
        lowercase, number, and special character.") }} {% for error in
        form.password.errors %}
        <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>

      <div class="mb-3">
        {{ form.confirm_password.label(class="form-label") }} {{
        form.confirm_password(class="form-control") }} {% for error in
        form.confirm_password.errors %}
        <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>

      {% if current_user.is_authenticated and current_user.is_admin %}
      <div class="mb-3">
        {{ form.role.label(class="form-label") }} {{
        form.role(class="form-control") }} {% for error in form.role.errors %}
        <div class="text-danger">{{ error }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <p class="small text-muted">
        Password must be at least 8 characters long and include:
      </p>
      <ul class="small text-muted">
        <li>One uppercase letter</li>
        <li>One lowercase letter</li>
        <li>One number</li>
        <li>One special character (!@#$%^&*)</li>
      </ul>

      <button type="submit" class="btn btn-primary w-100">Register</button>
    </form>
    <p class="mt-3 text-center">
      Already have an account? <a href="{{ url_for('main.login') }}">Login</a>
    </p>
  </div>
</div>
{% endblock %}
